<html>
<head>
    <title>Test Adjustment API</title>
</head>
<body>
    <h1>Test Adjustment Creation</h1>

    <form id="adjustmentForm">
        <label for="adjustment_type">Adjustment Type:</label>
        <select id="adjustment_type" required>
            <option value="credit_memo">Credit Memo</option>
            <option value="debit_memo">Debit Memo</option>
            <option value="write_off">Write Off</option>
            <option value="discount">Discount</option>
        </select><br><br>

        <label for="amount">Amount:</label>
        <input type="number" id="amount" step="0.01" required value="100"><br><br>

        <label for="reason">Reason:</label>
        <input type="text" id="reason" required value="Test adjustment"><br><br>

        <label for="adjustment_date">Date:</label>
        <input type="date" id="adjustment_date" required value="2024-01-01"><br><br>

        <label for="vendor_id">Vendor ID (for payable):</label>
        <input type="number" id="vendor_id" value="1"><br><br>

        <button type="submit">Create Adjustment</button>
    </form>

    <div id="result"></div>

    <script>
        document.getElementById('adjustmentForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const data = {
                adjustment_type: document.getElementById('adjustment_type').value,
                amount: parseFloat(document.getElementById('amount').value),
                reason: document.getElementById('reason').value,
                adjustment_date: document.getElementById('adjustment_date').value,
                vendor_id: parseInt(document.getElementById('vendor_id').value) || 0
            };

            // Remove vendor_id if it's 0 or empty
            if (data.vendor_id === 0) {
                delete data.vendor_id;
            }

            document.getElementById('result').innerHTML = 'Sending request...';

            try {
                const response = await fetch('http://localhost/integ-capstone/admin/api/adjustments.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.text();
                document.getElementById('result').innerHTML = `
                    <pre>Status: ${response.status}
${result}</pre>
                `;

                console.log('Request Data:', data);
                console.log('Response Status:', response.status);
                console.log('Response Body:', result);

            } catch (error) {
                document.getElementById('result').innerHTML = '<pre>Error: ' + error.message + '</pre>';
            }
        });
    </script>
</body>
</html>
